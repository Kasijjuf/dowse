FILE=$(shell find src -type f  -name *.c )
INCLUDEOPTS=-I../libparse-datetime -I/usr/include/mysql -I../kore/includes -Isrc/ -I../libdowse

WEBUI_PROTOTYPE_H=src/webui_prototype.h

all: cproto asset
	rm -f assets/*~
	../kore/kore flavor prod
	../kore/kore build

cproto:
	touch src/assets.h ;
	echo "/* Automatically generated by : make cproto */" > ${WEBUI_PROTOTYPE_H}
	cproto ${FILE} ${INCLUDEOPTS} >>  ${WEBUI_PROTOTYPE_H}

run:
	../kore/kore run

asset src/assetmap.c:
	@echo "Creating assetmap.c" ; ./map_assets > src/assetmap.c

debug: cproto src/assetmap.c
	rm -f assets/*~
	../kore/kore flavor dev
	cp -f conf/webui-debug.conf.dist conf/webui.conf
	../kore/kore build
##	./webui -r -n -f

clean:
	rm -f webui
	../kore/kore clean
#!/bin/bash

